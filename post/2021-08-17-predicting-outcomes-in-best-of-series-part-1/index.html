<!DOCTYPE html>
<html lang="en" dir="auto">

<head><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="robots" content="index, follow">
<title>Predicting Outcomes in &#34;Best Of&#34; Series - Part 1 | Nathan Wang-Ly</title>
<meta name="keywords" content="" />
<meta name="description" content="Why 3-2 series outcomes are so unlikely.">
<meta name="author" content="Nathan Wang-Ly">
<link rel="canonical" href="https://nathanwangly.github.io/post/2021-08-17-predicting-outcomes-in-best-of-series-part-1/" />
<link crossorigin="anonymous" href="/assets/css/stylesheet.min.6e80bd6394a4c444579a121285e0db06671d69c036f96745f781f10a8989fd32.css" integrity="sha256-boC9Y5SkxERXmhISheDbBmcdacA2&#43;WdF94HxComJ/TI=" rel="preload stylesheet" as="style">
<link rel="preload" href="/images/profile_photo.jpg" as="image">
<script defer crossorigin="anonymous" src="/assets/js/highlight.min.7680afc38aa6b15ddf158a4f3780b7b1f7dde7e91d26f073e6229bb7a0793c92.js" integrity="sha256-doCvw4qmsV3fFYpPN4C3sffd5&#43;kdJvBz5iKbt6B5PJI="
    onload="hljs.initHighlightingOnLoad();"></script>
<link rel="icon" href="https://nathanwangly.github.io/favicon.ico">
<link rel="icon" type="image/png" sizes="16x16" href="https://nathanwangly.github.io/favicon-16x16.png">
<link rel="mask-icon" href="https://nathanwangly.github.io/safari-pinned-tab.svg">
<meta name="theme-color" content="#2e2e33">
<meta name="msapplication-TileColor" content="#2e2e33">
<meta name="generator" content="Hugo 0.87.0" />
<meta property="og:title" content="Predicting Outcomes in &#34;Best Of&#34; Series - Part 1" />
<meta property="og:description" content="Why 3-2 series outcomes are so unlikely." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://nathanwangly.github.io/post/2021-08-17-predicting-outcomes-in-best-of-series-part-1/" /><meta property="og:image" content="https://nathanwangly.github.io/47"/><meta property="article:section" content="post" />
<meta property="article:published_time" content="2021-08-17T00:00:00&#43;00:00" />
<meta property="article:modified_time" content="2021-08-17T00:00:00&#43;00:00" /><meta property="og:site_name" content="ExampleSite" />

<meta name="twitter:card" content="summary_large_image"/>
<meta name="twitter:image" content="https://nathanwangly.github.io/47"/>

<meta name="twitter:title" content="Predicting Outcomes in &#34;Best Of&#34; Series - Part 1"/>
<meta name="twitter:description" content="Why 3-2 series outcomes are so unlikely."/>


<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [
    {
      "@type": "ListItem",
      "position":  1 ,
      "name": "Posts",
      "item": "https://nathanwangly.github.io/post/"
    }, 
    {
      "@type": "ListItem",
      "position":  2 ,
      "name": "Predicting Outcomes in \"Best Of\" Series - Part 1",
      "item": "https://nathanwangly.github.io/post/2021-08-17-predicting-outcomes-in-best-of-series-part-1/"
    }
  ]
}
</script>
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "Predicting Outcomes in \"Best Of\" Series - Part 1",
  "name": "Predicting Outcomes in \u0022Best Of\u0022 Series - Part 1",
  "description": "Why 3-2 series outcomes are so unlikely.",
  "keywords": [
    
  ],
  "articleBody": "\r\rAcross all types of head-to-head competitions, winners are determined through “best of” series, where competitors must win the majority of the games in the series. For example, e-sports competitions (e.g., League of Legends, Super Smash Bros. Melee) commonly use Best of 5 series, where the team that first reaches 3 wins is considered the winner.\nBefore the start of a series, it is typical for analysts to be asked for their predictions. In the case of a Best of 5 series, analysts can predict three possible series scores: 3-0, 3-1, or 3-2 (assuming they know the stronger team/player). These predictions often strike me as being based on some form of intuition; for example, analysts frequently predict a 3-2 score because two teams seem relatively evenly matched.\nThis got me thinking - when should you expect a series to go 3-0, 3-1, or 3-2? If you expect a team to have an X% chance of winning each game (or on average, they will win Y out of 10 games), what series score should you predict?\nCalculating the probability of each series outcomes\rLet’s start by making three assumptions:\nFirst, of the two players/teams, you know which team is better.\rSecond, you know (or can estimate) the percentage of games they should win against the other team. For example, Team A should beat Team B 70% of the time.\rThird (and most critically for these calculations), the likelihood of the team winning each game is independent1.\r\rWith these assumptions, we can calculate the probability of each series outcome!\nSuppose that you have two teams competing in a Best of 5 series: Team A and Team B. You believe that Team A is the better team, and that their (independent) probability of winning each game is \\(p\\).\nOutcome 1: 3-0\rThe first possible series outcome is a 3-0. Expressed in wins (W) and losses (L), this would be a WWW series. The probability of Team A winning all 3 games would be \\(p \\times p \\times p = p^3\\).\n\rOutcome 2: 3-1\rWhat about a 3-1 series? Those familiar with binomial probability will recall that the probability of 3 wins and 1 loss would be \\(p^3 \\times (1-p)\\). However, we also need to multiply this by the number of ways in which a series could go 3-1.\nThere happen to be 3 ways that this can happen: LWWW, WLWW, or WWLW. Keep in mind that the series WWWL is not possible, as the series would have ended 3-0.\nSo then, the probability of a 3-1 series is \\(3p^3(1-p)\\).\n\rOutcome 3: 3-2\rFinally, the series could go 3-2. The probability of 3 wins and 2 losses would be \\(p^3 \\times (1-p)^2\\).\nThere are 6 ways a series could go 3-2: LLWWW, LWLWW, LWWLW, WLLWW, WLWLW, WWLLW.\nTherefore, the probability of a 3-2 series is \\(6p^3(1-p)^2\\).\n\rExample\rTo make these probabilities tangible, let’s input in a value for \\(p\\). Let’s say that you think Team A has a 75% chance of winning each game. The respective probabilities of the three series outcomes would be:\n\r3-0: \\(0.75^3 = 0.422\\), or a 42.2% chance\r3-1: \\(3 \\times 0.75^3 \\times 0.25 = 0.316\\), or a 31.6% chance\r3-2: \\(6 \\times 0.75^3 \\times 0.25^2 = 0.158\\) or a 15.8% chance\r\rThis would mean the most likely series outcome is a 3-0 for Team A! Note that the probabilities here do not sum to 1 (they sum to 0.896) because there is an 11.4% chance that Team A would lose the series, either 0-3, 1-3, or 2-3.\n\r\rComparing the probabilities of each series outcomes\rNow that we know the probability of each outcome as a function of \\(p\\), we can calculate it for all values between 0.5 and 1 (since we assume that the team we have chosen is more likely to win).\nThis can easily be done in R.\nFirst, create a dataframe with the series scores and probabilities.\ndata % head(5)\r## score p_win\r## 1 3-0 0.50\r## 2 3-0 0.51\r## 3 3-0 0.52\r## 4 3-0 0.53\r## 5 3-0 0.54\rNext, we can apply the probabilities from the earlier section.\ndata % mutate(p_outcome = case_when(\r# If 3-0\rscore == '3-0' ~ p_win**3,\r# If 3-1\rscore == '3-1' ~ 3*(p_win**3)*(1-p_win),\r# If 3-2\rscore == '3-2' ~ 6*(p_win**3)*((1-p_win)**2)\r))\r# Probabilities when p = 0.75\rdata %% filter(p_win == 0.75)\r## score p_win p_outcome\r## 1 3-0 0.75 0.4218750\r## 2 3-1 0.75 0.3164062\r## 3 3-2 0.75 0.1582031\rWe can see that the probabilities match what we calculated earlier!\nFinally, we can create a plot to help us visualise how these probabilities change.\ndata %% ggplot(aes(x = p_win, y = p_outcome, colour = score)) + geom_path() + scale_x_continuous(labels = scales::percent_format(accuracy = 1)) +\rscale_y_continuous(labels = scales::percent_format(accuracy = 1)) + labs(x = 'Probability of Team A winning each game',\ry = 'Probability of series outcome',\rcolour = 'Series outcome') + theme_bw()\r\rTakeaways\rWhat can we take away from this plot?\nWhen \\(p\\) is 0.50 (you think both teams are exactly evenly matched), it is equally likely that the series will go 3-1 or 3-2. There’s an 18.8% chance of each, which beats the 12.5% chance of a 3-0.\ndata %% filter(p_win == 0.5)\r## score p_win p_outcome\r## 1 3-0 0.5 0.1250\r## 2 3-1 0.5 0.1875\r## 3 3-2 0.5 0.1875\rIf you think the chances of Team A winning each game are between 50% and 66%, the most likely outcome is a 3-1.\n\rIf Team A has a 66% chance of winning, the probability of a 3-1 series (29.3%) is slightly higher than a 3-0 series (28.7%).\rIf this increases to 67%, the probability of a 3-0 series (30.1%) overtakes the probability of a 3-1 series (29.8%).\r\rdata %% filter(p_win %in% c(0.66, 0.67))\r## score p_win p_outcome\r## 1 3-0 0.66 0.2874960\r## 2 3-0 0.67 0.3007630\r## 3 3-1 0.66 0.2932459\r## 4 3-1 0.67 0.2977554\r## 5 3-2 0.66 0.1994072\r## 6 3-2 0.67 0.1965185\rIf you think Team A has anything higher than a 67% chance of winning, the most likely outcome is a 3-0 series.\nInterestingly, this means, that a 3-2 series is never the single-most likely outcome. Even if you believe that two teams are perfectly matched, it only becomes equally likely as a 3-1 series. (Perhaps this may have been intuitive to others, but it came as a surprise to me!)\n\rConcluding thoughts\rThis was an interesting exercise for myself to understand how I should expect a Best of series to go based on my estimates of team/player strengths. It definitely came as a surprise to learn how unlikely 3-2 series are (though this may have been intuitive to others)!\nNaturally, the calculations are only specific to a Best of 5 series, and they also assume that your goal is to predict the most likely outcome (which it would be, if you were an analyst).\nIn the next two parts, we’ll expand in two directions:\nHow would we generalise these probability calculations to other (odd) Best of series? E.g., a Best of 3, Best of 7, etc.\rWould we choose differently if our goal was not to predict the outcome, but maximise our expected value in betting on the right outcome?\r\r1 In reality, this is unlikely to be the case for a number of reasons. One such reason is that momentum often seems to play a pivotal role in the outcome of a series. For example, if a team loses a long, drawn out game, this may affect their mentality and performance in the subsequent games. ↩︎\n\r",
  "wordCount" : "1312",
  "inLanguage": "en",
  "datePublished": "2021-08-17T00:00:00Z",
  "dateModified": "2021-08-17T00:00:00Z",
  "author":{
    "@type": "Person",
    "name": "Nathan Wang-Ly"
  },
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "https://nathanwangly.github.io/post/2021-08-17-predicting-outcomes-in-best-of-series-part-1/"
  },
  "publisher": {
    "@type": "Organization",
    "name": "Nathan Wang-Ly",
    "logo": {
      "@type": "ImageObject",
      "url": "https://nathanwangly.github.io/favicon.ico"
    }
  }
}
</script>

    <script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS_HTML"></script>
    
    <script type="text/x-mathjax-config">
    MathJax.Hub.Config({
        tex2jax: {
            inlineMath: [ ['$','$'], ["\\(","\\)"] ],
            displayMath: [ ['$$','$$'], ["\\[","\\]"] ],
            processEscapes: true,
            processEnvironments: true
        },
        // Center justify equations in code and markdown cells. Elsewhere
        // we use CSS to left justify single line equations in code cells.
        displayAlign: 'center',
        "HTML-CSS": {
            styles: {'.MathJax_Display': {"margin": 0}},
            linebreaks: { automatic: true }
        }
    });
    </script>
    
</head>

<body class="" id="top">
<noscript>
    <style type="text/css">
        #theme-toggle,
        .top-link {
            display: none;
        }

    </style>
</noscript>

<header class="header">
    <nav class="nav">
        <div class="logo">
            <a href="https://nathanwangly.github.io/" accesskey="h" title="NWL (Alt + H)">
                <img src="/images/profile_photo.jpg" alt="logo" aria-label="logo"
                    height="35">NWL</a>
            <span class="logo-switches">
            </span>
        </div>
        <ul id="menu">
            <li>
                <a href="https://nathanwangly.github.io/about/" title="About">
                    <span>About</span>
                </a>
            </li>
            <li>
                <a href="https://nathanwangly.github.io/cv/" title="CV">
                    <span>CV</span>
                </a>
            </li>
            <li>
                <a href="https://nathanwangly.github.io/research" title="Research">
                    <span>Research</span>
                </a>
            </li>
            <li>
                <a href="https://nathanwangly.github.io/posts" title="Posts">
                    <span>Posts</span>
                </a>
            </li>
        </ul>
    </nav>
</header>
<main class="main">

<article class="post-single">
  <header class="post-header">
    
    <h1 class="post-title">
      Predicting Outcomes in &#34;Best Of&#34; Series - Part 1
    </h1>
    <div class="post-description">
      <i>Why 3-2 series outcomes are so unlikely.</i>
    </div>
    <div class="post-meta">August 17, 2021&nbsp;·&nbsp;7 min
</div>
  </header> 
  <div class="post-content">
<script src="https://nathanwangly.github.io/post/2021-08-17-predicting-outcomes-in-best-of-series-part-1/index_files/header-attrs/header-attrs.js"></script>


<p>Across all types of head-to-head competitions, winners are determined through “best of” series, where competitors must win the majority of the games in the series. For example, e-sports competitions (e.g., League of Legends, Super Smash Bros. Melee) commonly use Best of 5 series, where the team that first reaches 3 wins is considered the winner.</p>
<p>Before the start of a series, it is typical for analysts to be asked for their predictions. In the case of a Best of 5 series, analysts can predict three possible series scores: 3-0, 3-1, or 3-2 (assuming they know the stronger team/player). These predictions often strike me as being based on some form of intuition; for example, analysts frequently predict a 3-2 score because two teams seem relatively evenly matched.</p>
<p>This got me thinking - when should you expect a series to go 3-0, 3-1, or 3-2? If you expect a team to have an X% chance of winning each game (or on average, they will win Y out of 10 games), what series score should you predict?</p>
<div id="calculating-the-probability-of-each-series-outcomes" class="section level3">
<h3>Calculating the probability of each series outcomes</h3>
<p>Let’s start by making three assumptions:</p>
<ol style="list-style-type: decimal">
<li>First, of the two players/teams, you know which team is better.</li>
<li>Second, you know (or can estimate) the percentage of games they should win against the other team. For example, Team A should beat Team B 70% of the time.</li>
<li>Third (and most critically for these calculations), the likelihood of the team winning each game is independent<sup id="a1"><a href="#f1">1</a></sup>.</li>
</ol>
<p>With these assumptions, we can calculate the probability of each series outcome!</p>
<p>Suppose that you have two teams competing in a Best of 5 series: Team A and Team B. You believe that Team A is the better team, and that their (independent) probability of winning each game is <span class="math inline">\(p\)</span>.</p>
<div id="outcome-1-3-0" class="section level4">
<h4>Outcome 1: 3-0</h4>
<p>The first possible series outcome is a 3-0. Expressed in wins (W) and losses (L), this would be a <em>WWW</em> series. The probability of Team A winning all 3 games would be <span class="math inline">\(p \times p \times p = p^3\)</span>.</p>
</div>
<div id="outcome-2-3-1" class="section level4">
<h4>Outcome 2: 3-1</h4>
<p>What about a 3-1 series? Those familiar with binomial probability will recall that the probability of 3 wins and 1 loss would be <span class="math inline">\(p^3 \times (1-p)\)</span>. However, we also need to multiply this by the number of ways in which a series could go 3-1.</p>
<p>There happen to be 3 ways that this can happen: <em>LWWW</em>, <em>WLWW</em>, or <em>WWLW</em>. Keep in mind that the series <em>WWWL</em> is not possible, as the series would have ended 3-0.</p>
<p>So then, the probability of a 3-1 series is <span class="math inline">\(3p^3(1-p)\)</span>.</p>
</div>
<div id="outcome-3-3-2" class="section level4">
<h4>Outcome 3: 3-2</h4>
<p>Finally, the series could go 3-2. The probability of 3 wins and 2 losses would be <span class="math inline">\(p^3 \times (1-p)^2\)</span>.</p>
<p>There are 6 ways a series could go 3-2: <em>LLWWW</em>, <em>LWLWW</em>, <em>LWWLW</em>, <em>WLLWW</em>, <em>WLWLW</em>, <em>WWLLW</em>.</p>
<p>Therefore, the probability of a 3-2 series is <span class="math inline">\(6p^3(1-p)^2\)</span>.</p>
</div>
<div id="example" class="section level4">
<h4>Example</h4>
<p>To make these probabilities tangible, let’s input in a value for <span class="math inline">\(p\)</span>. Let’s say that you think Team A has a 75% chance of winning each game. The respective probabilities of the three series outcomes would be:</p>
<ul>
<li>3-0: <span class="math inline">\(0.75^3 = 0.422\)</span>, or a 42.2% chance</li>
<li>3-1: <span class="math inline">\(3 \times 0.75^3 \times 0.25 = 0.316\)</span>, or a 31.6% chance</li>
<li>3-2: <span class="math inline">\(6 \times 0.75^3 \times 0.25^2 = 0.158\)</span> or a 15.8% chance</li>
</ul>
<p>This would mean the most likely series outcome is a 3-0 for Team A! Note that the probabilities here do not sum to 1 (they sum to 0.896) because there is an 11.4% chance that Team A would lose the series, either 0-3, 1-3, or 2-3.</p>
</div>
</div>
<div id="comparing-the-probabilities-of-each-series-outcomes" class="section level3">
<h3>Comparing the probabilities of each series outcomes</h3>
<p>Now that we know the probability of each outcome as a function of <span class="math inline">\(p\)</span>, we can calculate it for all values between 0.5 and 1 (since we assume that the team we have chosen is more likely to win).</p>
<p>This can easily be done in R.</p>
<p>First, create a dataframe with the series scores and probabilities.</p>
<pre class="r"><code>data &lt;- data.frame(
  # repeat each outcome 51 times
  score = rep(c(&#39;3-0&#39;, &#39;3-1&#39;, &#39;3-2&#39;), each = 51),
  # repeat the sequence of probabilities from 0.5-1 (in 0.01 increments) once for each outcome
  p_win = rep(seq(0.5, 1, 0.01), times = 3)
)

# Preview of first few rows
data %&gt;% 
  head(5)</code></pre>
<pre><code>##   score p_win
## 1   3-0  0.50
## 2   3-0  0.51
## 3   3-0  0.52
## 4   3-0  0.53
## 5   3-0  0.54</code></pre>
<p>Next, we can apply the probabilities from the earlier section.</p>
<pre class="r"><code>data &lt;- data %&gt;% 
  mutate(p_outcome = case_when(
    # If 3-0
    score == &#39;3-0&#39; ~ p_win**3,
    # If 3-1
    score == &#39;3-1&#39; ~ 3*(p_win**3)*(1-p_win),
    # If 3-2
    score == &#39;3-2&#39; ~ 6*(p_win**3)*((1-p_win)**2)
  ))

# Probabilities when p = 0.75
data %&gt;% 
  filter(p_win == 0.75)</code></pre>
<pre><code>##   score p_win p_outcome
## 1   3-0  0.75 0.4218750
## 2   3-1  0.75 0.3164062
## 3   3-2  0.75 0.1582031</code></pre>
<p>We can see that the probabilities match what we calculated earlier!</p>
<p>Finally, we can create a plot to help us visualise how these probabilities change.</p>
<pre class="r"><code>data %&gt;% 
  ggplot(aes(x = p_win, y = p_outcome, colour = score)) + 
  geom_path() + 
  scale_x_continuous(labels = scales::percent_format(accuracy = 1)) +
  scale_y_continuous(labels = scales::percent_format(accuracy = 1)) + 
  labs(x = &#39;Probability of Team A winning each game&#39;,
       y = &#39;Probability of series outcome&#39;,
       colour = &#39;Series outcome&#39;) + 
  theme_bw()</code></pre>
<p><img src="https://nathanwangly.github.io/post/2021-08-17-predicting-outcomes-in-best-of-series-part-1/index_files/figure-html/unnamed-chunk-3-1.png" width="672" /></p>
</div>
<div id="takeaways" class="section level3">
<h3>Takeaways</h3>
<p>What can we take away from this plot?</p>
<p>When <span class="math inline">\(p\)</span> is 0.50 (you think both teams are exactly evenly matched), it is equally likely that the series will go 3-1 or 3-2. There’s an 18.8% chance of each, which beats the 12.5% chance of a 3-0.</p>
<pre class="r"><code>data %&gt;% 
  filter(p_win == 0.5)</code></pre>
<pre><code>##   score p_win p_outcome
## 1   3-0   0.5    0.1250
## 2   3-1   0.5    0.1875
## 3   3-2   0.5    0.1875</code></pre>
<p>If you think the chances of Team A winning each game are between 50% and 66%, the most likely outcome is a 3-1.</p>
<ul>
<li>If Team A has a 66% chance of winning, the probability of a 3-1 series (29.3%) is slightly higher than a 3-0 series (28.7%).</li>
<li>If this increases to 67%, the probability of a 3-0 series (30.1%) overtakes the probability of a 3-1 series (29.8%).</li>
</ul>
<pre class="r"><code>data %&gt;% 
  filter(p_win %in% c(0.66, 0.67))</code></pre>
<pre><code>##   score p_win p_outcome
## 1   3-0  0.66 0.2874960
## 2   3-0  0.67 0.3007630
## 3   3-1  0.66 0.2932459
## 4   3-1  0.67 0.2977554
## 5   3-2  0.66 0.1994072
## 6   3-2  0.67 0.1965185</code></pre>
<p>If you think Team A has anything higher than a 67% chance of winning, the most likely outcome is a 3-0 series.</p>
<p>Interestingly, this means, that a 3-2 series is never the single-most likely outcome. Even if you believe that two teams are perfectly matched, it only becomes equally likely as a 3-1 series. (Perhaps this may have been intuitive to others, but it came as a surprise to me!)</p>
</div>
<div id="concluding-thoughts" class="section level3">
<h3>Concluding thoughts</h3>
<p>This was an interesting exercise for myself to understand how I should expect a Best of series to go based on my estimates of team/player strengths. It definitely came as a surprise to learn how unlikely 3-2 series are (though this may have been intuitive to others)!</p>
<p>Naturally, the calculations are only specific to a Best of 5 series, and they also assume that your goal is to predict the most likely outcome (which it would be, if you were an analyst).</p>
<p>In the next two parts, we’ll expand in two directions:</p>
<ol style="list-style-type: decimal">
<li>How would we generalise these probability calculations to other (odd) Best of series? E.g., a Best of 3, Best of 7, etc.</li>
<li>Would we choose differently if our goal was not to predict the outcome, but maximise our expected value in betting on the right outcome?</li>
</ol>
<hr />
<p><b id="f1">1</b> In reality, this is unlikely to be the case for a number of reasons. One such reason is that momentum often seems to play a pivotal role in the outcome of a series. For example, if a team loses a long, drawn out game, this may affect their mentality and performance in the subsequent games. <a href="#a1">↩︎</a></p>
</div>


  </div>
  <footer class="post-footer">
<nav class="paginav">
  <a class="next" href="https://nathanwangly.github.io/post/2020-12-19-superannuation-comparison-tool/">
    <span class="title">Next Page »</span>
    <br>
    <span>Superannuation Comparison Tool</span>
  </a>
</nav>

  </footer>
</article>
    </main>
    <footer class="footer">
    <span>&copy; 2021 <a href="https://nathanwangly.github.io/">Nathan Wang-Ly</a></span>
    <span>
        Powered by
        <a href="https://gohugo.io/" rel="noopener noreferrer" target="_blank">Hugo</a> &
        <a href="https://git.io/hugopapermod" rel="noopener" target="_blank">PaperMod</a>
    </span>
</footer>
<a href="#top" aria-label="go to top" title="Go to Top (Alt + G)">
    <button class="top-link" id="top-link" type="button" accesskey="g">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentColor">
            <path d="M12 6H0l6-6z" />
        </svg>
    </button>
</a>

<script>
    let menu = document.getElementById('menu')
    menu.scrollLeft = localStorage.getItem("menu-scroll-position");
    menu.onscroll = function () {
        localStorage.setItem("menu-scroll-position", menu.scrollLeft);
    }

    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener("click", function (e) {
            e.preventDefault();
            var id = this.getAttribute("href").substr(1);
            if (!window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({
                    behavior: "smooth"
                });
            } else {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView();
            }
            if (id === "top") {
                history.replaceState(null, null, " ");
            } else {
                history.pushState(null, null, `#${id}`);
            }
        });
    });

</script>
<script>
    var mybutton = document.getElementById("top-link");
    window.onscroll = function () {
        if (document.body.scrollTop > 800 || document.documentElement.scrollTop > 800) {
            mybutton.style.visibility = "visible";
            mybutton.style.opacity = "1";
        } else {
            mybutton.style.visibility = "hidden";
            mybutton.style.opacity = "0";
        }
    };

</script>
</body>

</html>
